<!DOCTYPE html>
<html>
    <title>EVM Bytecode Analyzer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/w3.css">
    <link rel="stylesheet" href="/main.css">

    <head>
        <script src="jquery-3.6.1.js"></script>

        <script>
            // this jQuery function runs once the page is loaded
            $(document).ready(function(){
                // show the disassembler page when site is first loaded
                $(".disassembler-items").show();
                $(".debugger-items").hide();
            });


            $(function() {
                // add click event listener to Disassembler button
                $(".btn-disassembler").click(function() {
                    // hide the Debugger items and show the Disassembler items
                    $(".debugger-items").hide();
                    $(".disassembler-items").show();
                });

                // add click event listener to Debugger button
                $(".btn-debugger").click(function() {
                    // hide the Disassembler items and show the Debugger items
                    $(".disassembler-items").hide();
                    $(".debugger-items").show();
                });

                // add a click event listener to the Disassembly tab's Parse Bytecode button
                $("#disassembler-items-bytecode-button").click(function(){
                    // Send an API request to /parseBytecode
                    var bytecode = new Object();
                    bytecode.bytecode = $("#disassembler-items-bytecode-input").val();
                    $.post({
                        url: 'http://127.0.0.1:12345/api/v1/parseBytecode',
                        contentType: 'application/json',
                        data: JSON.stringify(bytecode),
                        success: function(response) {
                            var instructions = response;
                            // remove the rows from the table
                            var instructionTable = $("#disassembler-items-instructions-table");
                            instructionTable.empty();
                            var row = $("<tr>");
                            $('<th style="width: 20%;">').text("Program Counter").appendTo(row);
                            $('<th style="width: 45%;">').text("Human Readable").appendTo(row);
                            $('<th style="width: 35%;">').text("Hex").appendTo(row);
                            row.appendTo(instructionTable);
                            $.each(instructions, function(key, value){
                                var row = $("<tr>");
                                $("<td>").text(key).appendTo(row);
                                $("<td>").text(value[0]).appendTo(row);
                                $("<td>").text(value[1]).appendTo(row);
                                row.appendTo(instructionTable);
                                console.log(key, value[0], value[1]);
                            });
                        },
                        error: function(xhr, status, error) {
                            console.error('Error: ' + error);
                        }
                    });
                });
            });
        </script>
    </head>

    <body>
        <div class="topnav">
            <a href="#" class="btn-disassembler">Disassembler</a>
            <a href="#" class="btn-debugger">Debugger</a>
        </div>
          
        <div class="sidebar">
            <ul>
                <li><a href="#">default</a></li>
            </ul>
        </div>

        <div class="main-content">
            <div class="disassembler-items">
                <!-- items to show when Disassembler button is clicked -->
                <div class="disassembler-items-bytecode">
                    <p>bytecode</p>
                    <input id="disassembler-items-bytecode-input" type="text" placeholder="60806040526000340361001157600080fd5b610206806100206000396000f3fe60806040526004361061001e5760003560e01c8063a30da70d14610023575b600080fd5b61002b61002d565b005b610035610106565b610070816000019067ffffffffffffffff16908167ffffffffffffffff168152505034815101815261006d816000015163ffffffff16565b50565b61007861007a565b565b600034146100bd576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016100b490610181565b60405180910390fd5b3373ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f19350505050158015610103573d6000803e3d6000fd5b50565b604051806020016040528061011a81525090565b6101226101a1565b565b600082825260208201905092915050565b7f646f6e742073656e642066756e64732100000000000000000000000000000000600082015250565b600061016b601083610124565b915061017682610135565b602082019050919050565b6000602082019050818103600083015261019a8161015e565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052605160045260246000fdfea26469706673582212202984a32427ae50c08b30f852a00a90f1afccf0ee5e5ceeb78f8227cdb1ec28ad64736f6c63430008110033" value="60806040526000340361001157600080fd5b610206806100206000396000f3fe60806040526004361061001e5760003560e01c8063a30da70d14610023575b600080fd5b61002b61002d565b005b610035610106565b610070816000019067ffffffffffffffff16908167ffffffffffffffff168152505034815101815261006d816000015163ffffffff16565b50565b61007861007a565b565b600034146100bd576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016100b490610181565b60405180910390fd5b3373ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f19350505050158015610103573d6000803e3d6000fd5b50565b604051806020016040528061011a81525090565b6101226101a1565b565b600082825260208201905092915050565b7f646f6e742073656e642066756e64732100000000000000000000000000000000600082015250565b600061016b601083610124565b915061017682610135565b602082019050919050565b6000602082019050818103600083015261019a8161015e565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052605160045260246000fdfea26469706673582212202984a32427ae50c08b30f852a00a90f1afccf0ee5e5ceeb78f8227cdb1ec28ad64736f6c63430008110033">
                    <button id="disassembler-items-bytecode-button">Parse Bytecode</button>
                </div>
                <div class="disassembler-items-instructions">
                    <p>Instructions</p>
                    <table id="disassembler-items-instructions-table" class="disassembler-items-instructions-table">
                        <tr>
                            <th style="width: 20%;">Program Counter</th>
                            <th style="width: 45%;">Human Readable</th>
                            <th style="width: 35%;">Hex</th>
                        </tr>
                    </table>
                </div>
            </div>
            
            <div class="debugger-items">
                <!-- items to show when Debugger button is clicked -->
                <p>debugger</p>
            </div>
        </div>

    </body>

</html>